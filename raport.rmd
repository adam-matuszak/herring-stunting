---
title: "Karłowacenie Śledzi"
author: "Adam Matuszak"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Wyniki analizy

## Wykorzystane biblioteki

```{r}
library(ggplot2)
```

## Powtarzalność danych

```{r}
set.seed(1)
```

## Wczytanie danych

Wczytanie daych odbywa się poprzez załadowanie informacji z pliku sledzie.csv. Plik ten jest załączony do repozytorium.

```{r}
data = read.csv("sledzie.csv", TRUE, sep = ',')
```

## Czeyszczenie zbioru

Czyszczenie zbioru przebiega na zasadzie zamienienia symboli ? występujących w pliku na wartość NA. Następnie tworzymy nowy zbiór, w którym pomijamy wszystkie rekordy posiadające w którejkolwiek kolumnie wartość NA. Po wykoaniu tej operacji należy przekonwertować typy kolumn na numeryczne. 

```{r}
data[data=="?"]<-NA
df <- na.omit(data)
cols.num <- c("cfin1","cfin2","chel1","chel2","lcop1","lcop2","sst")
df[cols.num] <- sapply(df[cols.num],function(x) as.numeric(as.character(x)))
clear <- na.omit(df)
```

## Charaktrystyki zbioru

### Kolumny
```{r ,echo=FALSE}
colnames(clear)
```

* X: liczba porządkowa;
* length: długość złowionego śledzia [cm];
* cfin1: dostępność planktonu [zagęszczenie Calanus finmarchicus gat. 1];
* cfin2: dostępność planktonu [zagęszczenie Calanus finmarchicus gat. 2];
* chel1: dostępność planktonu [zagęszczenie Calanus helgolandicus gat. 1];
* chel2: dostępność planktonu [zagęszczenie Calanus helgolandicus gat. 2];
* lcop1: dostępność planktonu [zagęszczenie widłonogów gat. 1];
* lcop2: dostępność planktonu [zagęszczenie widłonogów gat. 2];
* fbar: natężenie połowów w regionie [ułamek pozostawionego narybku];
* recr: roczny narybek [liczba śledzi];
* cumf: łączne roczne natężenie połowów w regionie [ułamek pozostawionego narybku];
* totaln: łączna liczba ryb złowionych w ramach połowu [liczba śledzi];
* sst: temperatura przy powierzchni wody [°C];
* sal: poziom zasolenia wody [Knudsen ppt];
* xmonth: miesiąc połowu [numer miesiąca];
* nao: oscylacja północnoatlantycka [mb].

### Wielkość zbioru przed wyczyszczeniem danych
```{r ,echo=FALSE}
nrow(data)
```

### Wielkość zbioru po wyczyszczeniem danych
```{r ,echo=FALSE}
nrow(clear)
```

### Analiza wartości poszczególnych kolumn czystego zbioru
```{r ,echo=FALSE}
summary(clear[,-1])
```

## Analiza atrybutów

```{r ,echo=FALSE}
boxplot(clear$length, main = "Rozkład wartości dla atrybutu length", horizontal=TRUE)
boxplot(clear$cfin1, main = "Rozkład wartości dla atrybutu cfin1", horizontal=TRUE)
boxplot(clear$cfin2, main = "Rozkład wartości dla atrybutu cfin2", horizontal=TRUE)
boxplot(clear$chel1, main = "Rozkład wartości dla atrybutu chel1", horizontal=TRUE)
boxplot(clear$chel2, main = "Rozkład wartości dla atrybutu chel2", horizontal=TRUE)
boxplot(clear$lcop1, main = "Rozkład wartości dla atrybutu lcop1", horizontal=TRUE)
boxplot(clear$lcop2, main = "Rozkład wartości dla atrybutu lcop2", horizontal=TRUE)
boxplot(clear$fbar, main = "Rozkład wartości dla atrybutu fbar", horizontal=TRUE)
boxplot(clear$recr, main = "Rozkład wartości dla atrybutu recr", horizontal=TRUE)
boxplot(clear$cumf, main = "Rozkład wartości dla atrybutu cumf", horizontal=TRUE)
boxplot(clear$totaln, main = "Rozkład wartości dla atrybutu totaln", horizontal=TRUE)
boxplot(clear$sst, main = "Rozkład wartości dla atrybutu sst", horizontal=TRUE)
boxplot(clear$sal, main = "Rozkład wartości dla atrybutu sal", horizontal=TRUE)
boxplot(clear$xmonth, main = "Rozkład wartości dla atrybutu xmonth", horizontal=TRUE)
boxplot(clear$nao, main = "Rozkład wartości dla atrybutu nao", horizontal=TRUE)
```

## Korelację pomiędzy atrybutami

Korelacja pomiędzy poszczególnymi atrybutami, a długością śledzia

```{r ,echo=FALSE}

v = c(
  cor(clear$length,clear$cfin1),
  cor(clear$length,clear$cfin2),
  cor(clear$length,clear$chel1),
  cor(clear$length,clear$chel2),
  cor(clear$length,clear$lcop1),
  cor(clear$length,clear$lcop2),
  cor(clear$length,clear$fbar),
  cor(clear$length,clear$recr),
  cor(clear$length,clear$cumf),
  cor(clear$length,clear$totaln),
  cor(clear$length,clear$sst),
  cor(clear$length,clear$sal),
  cor(clear$length,clear$xmonth),
  cor(clear$length,clear$nao)
) 

names(v) = c("cfin1", "cfin2", "chel1", "chel2", "lcop1", "lcop2", "fbar", "recr", "cumf", "totaln", "sst", "sal", "xmonth", "nao")

v
```

Największą wartość bezwzględną posiada korelacja pomiędzy długością śledzia, a temperaturą przy powierzchni. Według badania te wartości są skorelowane ujemnie, a stopień korelacji jest słaby.

## Zmiana rozmiarów śledzi w czasie

```{r ,echo=FALSE}
ggplot(data=clear[,c(1,2)], aes(x=X, y=length)) +
  geom_smooth()
```

## Prognoza rozmiarów śledzi

```{r}

```

## Analiza modelu regresji

```{r}

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
